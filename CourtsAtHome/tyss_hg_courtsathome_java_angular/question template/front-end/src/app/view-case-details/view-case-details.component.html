<div class="fluid-container d-flex flex-column">
  <div class="d-flex flex-row justify-content-between card">
    <img class="kyan-img ms-3 my-2" src="../../assets/kyan.png" alt="" />
    <img class="logout-img me-2 my-2" (click)="logout()" src="../../assets/Component 1 â€“ 1.svg" alt="" />
  </div>
  <div class="ms-5 mt-5">
    <form [formGroup]="searchbyForm">
      <mat-radio-group class="ms-5" aria-label="Select an option" (change)="updateControls(searchbyForm.value)" formControlName="searchBy">
        <mat-radio-button class="ms-5" name="searchBy" value="vehicleNo">Vehicle No.</mat-radio-button>
        <mat-radio-button name="searchBy" value="mobileNo">Mobile No.</mat-radio-button>
      </mat-radio-group>
    </form>
  </div>
  <div class="d-flex justify-content-center mt-2">
    <form [formGroup]="searchBox" (ngSubmit)="searchViolation(searchBox.value)">
      <input class="ms-5 ps-3" type="text" formControlName="vehicalNo" placeholder="Enter your vehicle No. here"
        *ngIf="searchBox.controls['vehicalNo']" />
      <input class="ms-5 ps-3" type="text" formControlName="mobileNo" placeholder="Mobile No."
        *ngIf="searchBox.controls['mobileNo']" />
      <button (click)="showTable()" class="btn search-btn" type="submit">
        Search
      </button>
    </form>
  </div>
  <div *ngIf="isCaseDetailsExists" class="d-flex justify-content-center">
    <mat-tab-group>
      <mat-tab label="Active Cases">
        <table mat-table [dataSource]="activeCases" class="mat-elevation-z8">
          <!-- case name Column -->
          <ng-container matColumnDef="caseName">
            <th mat-header-cell *matHeaderCellDef>Case Name</th>
            <td mat-cell *matCellDef="let element">{{ element.caseName }}</td>
          </ng-container>

          <!-- date of violation Column -->
          <ng-container matColumnDef="Date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element">
              {{ element?.dateTime | date : "longDate" }}
            </td>
          </ng-container>

          <!-- time of violation Column -->
          <ng-container matColumnDef="Time">
            <th mat-header-cell *matHeaderCellDef>Time</th>
            <td mat-cell *matCellDef="let element">
              {{ element?.dateTime | date : "shortTime" }}
            </td>
          </ng-container>

          <!-- pay button Column -->
          <ng-container matColumnDef="Pay">
            <th mat-header-cell *matHeaderCellDef>Fine</th>
            <td mat-cell *matCellDef="let element">
              <button (click)="payViolation(element)" type="button" class="btn pay-lable" data-bs-toggle="modal"
                data-bs-target="#exampleModal">
                <span><small><strong>Pay Now</strong></small></span>
              </button>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </mat-tab>

      <mat-tab label="Closed Cases">
        <table mat-table [dataSource]="closedCases" class="mat-elevation-z8">
          <!-- case name Column -->
          <ng-container matColumnDef="caseName">
            <th mat-header-cell *matHeaderCellDef>Case Name</th>
            <td mat-cell *matCellDef="let element">{{ element.caseName }}</td>
          </ng-container>

          <!-- date of violation Column -->
          <ng-container matColumnDef="Date">
            <th mat-header-cell *matHeaderCellDef>Date</th>
            <td mat-cell *matCellDef="let element"> {{ element?.dateTime | date : "longDate" }}</td>
          </ng-container>

          <!-- time of violation Column -->
          <ng-container matColumnDef="Time">
            <th mat-header-cell *matHeaderCellDef>Time</th>
            <td mat-cell *matCellDef="let element">{{ element?.dateTime | date : "shortTime" }}</td>
          </ng-container>

          <!-- pay button Column -->
          <ng-container matColumnDef="Pay">
            <th mat-header-cell *matHeaderCellDef>Pay</th>
            <td mat-cell *matCellDef="let element">
              <div class="d-flex align-items-center">
                <object data="../../assets/icons/greencheck.svg" width="20" height="20"></object>
                <span class="p-2 text-success font-weight-bold">Paid</span>
              </div>
            </td>
          </ng-container>

          <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
        </table>
      </mat-tab>
    </mat-tab-group>
    <div></div>
  </div>
  <!-- Modal -->
  <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header text-center">
          <h5 class="modal-title" id="exampleModalLabel">Fine Details</h5>
          <button type="button" #closeModal class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div *ngIf="violationDetails" class="modal-body">
          <div class="d-flex align-items-center justify-content-between row" *ngFor="let key of payNowKeys">
            <p class="title  col-5"><strong>{{ key | titlecase }} :</strong></p>
            <p class="description col-7">{{ violationDetails[key] }}</p>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn pay-btn" (click)="updateCaseStatus(violationDetails)">Pay</button>
        </div>
      </div>
    </div>
  </div>
</div>
